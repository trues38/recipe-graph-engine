---
name: recipe-graph-engine
description: |
  ê·¸ë˜í”„ DB(Neo4j) ê¸°ë°˜ ë ˆì‹œí”¼ ì¶”ì²œ ì—”ì§„ êµ¬ì¶• ìŠ¤í‚¬. 
  ì¬ë£Œ â†’ ë ˆì‹œí”¼ ì—­ë°©í–¥ ì¿¼ë¦¬, ê±´ê°•/ë‹¤ì´ì–´íŠ¸ í•„í„°ë§, í˜ë¥´ì†Œë‚˜ë³„ ì‘ë‹µ ìƒì„±.
  
  Use when:
  - ë ˆì‹œí”¼ ë°ì´í„° ìˆ˜ì§‘/í¬ë¡¤ë§/êµ¬ì¡°í™”
  - Neo4j ìŠ¤í‚¤ë§ˆ ì„¤ê³„ ë° ë°ì´í„° ì ì¬
  - Cypher ì¿¼ë¦¬ ê°œë°œ (ì¬ë£Œ ë§¤ì¹­, ê±´ê°• í•„í„° ë“±)
  - í˜ë¥´ì†Œë‚˜ ê¸°ë°˜ ì‘ë‹µ ìƒì„± (ì—„ë§ˆë°¥, ë‹¤ì´ì–´íŠ¸ì½”ì¹˜ ë“±)
  - ë ˆì‹œí”¼ ì¶”ì²œ API/ì•± ê°œë°œ
---

# Recipe Graph Engine

ê·¸ë˜í”„ ê¸°ë°˜ ë ˆì‹œí”¼ ì¶”ì²œ ì—”ì§„. RAGê°€ ì•„ë‹Œ **ìƒíƒœ ê·¸ë˜í”„**ë¡œ ë ˆì‹œí”¼ë¥¼ êµ¬ì¡°í™”í•˜ì—¬ ë§¥ë½ ìˆëŠ” ì¶”ì²œ ì œê³µ.

## í•µì‹¬ ì°¨ë³„ì 

| ê¸°ì¡´ (RAG) | ê·¸ë˜í”„ ì—”ì§„ |
|------------|-------------|
| ë¬¸ì„œ ì²­í‚¹ + ì„ë² ë”© | ë…¸ë“œ/ì—£ì§€ êµ¬ì¡°í™” |
| "ê¹€ì¹˜ì°Œê°œ ë ˆì‹œí”¼ ì•Œë ¤ì¤˜" | "ëƒ‰ì¥ê³ ì— ì´ê²ƒë§Œ ìˆëŠ”ë° ë­ í•´ë¨¹ì§€?" |
| ë‹¨ë°©í–¥ ê²€ìƒ‰ | ì—­ë°©í–¥ ì¿¼ë¦¬ (ì¬ë£Œ â†’ ë ˆì‹œí”¼) |

## ì›Œí¬í”Œë¡œìš° ê°œìš”

```
Phase 1: ë°ì´í„° ìˆ˜ì§‘ (1-2ì¼)
    â†“
Phase 2: ê·¸ë˜í”„ ìŠ¤í‚¤ë§ˆ (0.5ì¼)
    â†“
Phase 3: ë°ì´í„° ì ì¬ (0.5ì¼)
    â†“
Phase 4: ì¿¼ë¦¬ ì—”ì§„ (1ì¼)
    â†“
Phase 5: í˜ë¥´ì†Œë‚˜ ì—”ì§„ (0.5ì¼)
    â†“
Phase 6: API ë˜í•‘ (0.5ì¼)
```

---

## Phase 1: ë°ì´í„° ìˆ˜ì§‘

### 1.1 ê³µê°œ ë°ì´í„°ì…‹

| ì†ŒìŠ¤ | ë‚´ìš© | ìš©ë„ |
|------|------|------|
| ë†ë¦¼ì¶•ì‚°ì‹í’ˆë¶€ | í•œì‹ ë ˆì‹œí”¼ DB | ê¸°ë³¸ ë ˆì‹œí”¼ |
| ì‹ì•½ì²˜ ì˜ì–‘ DB | í•œêµ­ ì‹í’ˆ ì˜ì–‘ì •ë³´ | ì¹¼ë¡œë¦¬/ì˜ì–‘ì†Œ |
| Recipe1M+ | 100ë§Œ+ ê¸€ë¡œë²Œ ë ˆì‹œí”¼ | í™•ì¥ìš© |
| USDA Food DB | ì˜ì–‘ì†Œ ì •ë³´ | ì˜ì–‘ ê³„ì‚° |

### 1.2 í¬ë¡¤ë§ (êµ¬ì¡°ë§Œ ì¶”ì¶œ)

**ì €ì¥í•˜ëŠ” ê²ƒ** (íŒ©íŠ¸): ì¬ë£Œ ëª©ë¡, ì¡°ë¦¬ ì‹œê°„, ë‚œì´ë„, ì¹´í…Œê³ ë¦¬, íƒœê·¸

**ì €ì¥ ì•ˆ í•˜ëŠ” ê²ƒ** (ì €ì‘ê¶Œ): ë ˆì‹œí”¼ ì›ë¬¸, ì¡°ë¦¬ ì„¤ëª… ë¬¸ì¥, ì´ë¯¸ì§€

### 1.3 LLM êµ¬ì¡°í™”

í¬ë¡¤ë§í•œ ë©”íƒ€ë°ì´í„°ë¥¼ LLMìœ¼ë¡œ ì •ê·œí™”. **ìƒì„¸**: `references/data-pipeline.md`

---

## Phase 2: ê·¸ë˜í”„ ìŠ¤í‚¤ë§ˆ

### ë…¸ë“œ íƒ€ì…

```
(:Ingredient)  - ì¬ë£Œ (ë¼ì§€ê³ ê¸°, ê¹€ì¹˜, ë‘ë¶€...)
(:Recipe)      - ë ˆì‹œí”¼ (ê¹€ì¹˜ì°Œê°œ, ëœì¥ì°Œê°œ...)
(:Goal)        - ëª©í‘œ (ë‹¤ì´ì–´íŠ¸, ë²Œí¬ì—…...)
(:Condition)   - ê±´ê°•ìƒíƒœ (ë‹¹ë‡¨, ê³ í˜ˆì••, í†µí’...)
(:Diet)        - ì‹ë‹¨ (ë¹„ê±´, ë½í† , í˜ìŠ¤ì½”...)
(:Technique)   - ê¸°ë²• (ìˆ˜ë¹„ë“œ, ì—ì–´í”„ë¼ì´ì–´...)
```

### ì—£ì§€ íƒ€ì…

```
(Ingredient)-[:REQUIRED_FOR {amount, unit}]->(Recipe)
(Ingredient)-[:CAN_REPLACE {ratio}]->(Ingredient)
(Recipe)-[:SUITABLE_FOR {score}]->(Goal)
(Recipe)-[:SAFE_FOR | :AVOID_FOR {reason}]->(Condition)
(Recipe)-[:COMPATIBLE_WITH]->(Diet)
(Recipe)-[:USES_TECHNIQUE]->(Technique)
```

**ìƒì„¸**: `references/schema.md`

---

## Phase 3: ë°ì´í„° ì ì¬

### ì ì¬ ìˆœì„œ

1. Ingredient ë…¸ë“œ â†’ 2. Recipe ë…¸ë“œ â†’ 3. REQUIRED_FOR ì—£ì§€ â†’ 4. ë©”íƒ€ ë…¸ë“œ/ì—£ì§€

**ìŠ¤í¬ë¦½íŠ¸**: `scripts/neo4j_loader.py`

---

## Phase 4: ì¿¼ë¦¬ ì—”ì§„

### í•µì‹¬ ì¿¼ë¦¬

**ì¬ë£Œ â†’ ë ˆì‹œí”¼ (ì—­ë°©í–¥)**
```cypher
MATCH (r:Recipe)-[:REQUIRED_FOR]-(i:Ingredient)
WHERE i.name IN $my_ingredients
WITH r, count(i) AS matched, size((r)-[:REQUIRED_FOR]-()) AS total
WITH r, round(matched * 100.0 / total) AS coverage
WHERE coverage >= 60
RETURN r.name, coverage ORDER BY coverage DESC LIMIT 10
```

**ìƒì„¸ ì¿¼ë¦¬ ëª©ë¡**: `references/queries.md`

---

## Phase 5: í˜ë¥´ì†Œë‚˜ ì—”ì§„

| í‹°ì–´ | í˜ë¥´ì†Œë‚˜ | í†¤ |
|------|----------|-----|
| FREE | ì—„ë§ˆë°¥ ğŸ‘©â€ğŸ³ | "ìš°ë¦¬ OOì´ ë­ í•´ë¨¹ì„ê¹Œ~ ì´ê±° í•´ë¨¹ì–´!" |
| PREMIUM | í‘ë°±ìš”ë¦¬ì‚¬ ğŸ–¤ | "ì´ ì¬ë£Œì—” ìˆ˜ë¹„ë“œê°€ ìµœì ì…ë‹ˆë‹¤" |
| PREMIUM | ë‹¤ì´ì–´íŠ¸ì½”ì¹˜ ğŸ’ª | "ì´ê±° ë¨¹ìœ¼ë©´ -300kcal ì ˆì•½!" |
| PREMIUM | ê±´ê°•ë§ì¶¤ ğŸ¥ | "ë‹¹ë‡¨ì— ì•ˆì „í•œ ë ˆì‹œí”¼ì…ë‹ˆë‹¤" |
| PREMIUM | ë¬´ì§€ê°œìš”ë¦¬ì‚¬ ğŸŒˆ | "ë™ë¬¼ ì—†ì´ë„ ì´ë ‡ê²Œ ë§›ìˆì–´ìš”" |

**ìƒì„¸**: `references/personas.md`

---

## Phase 6: API

```python
@app.post("/recommend")
async def recommend(ingredients: List[str], persona: str = "ì—„ë§ˆë°¥"):
    results = query_engine.find_recipes(ingredients)
    response = persona_engine.generate(results, persona)
    return {"recipes": results, "message": response}
```

---

## íŒŒì¼ ì°¸ì¡°

| íŒŒì¼ | ë‚´ìš© |
|------|------|
| `references/schema.md` | Neo4j ë…¸ë“œ/ì—£ì§€ ìƒì„¸ ìŠ¤í‚¤ë§ˆ |
| `references/queries.md` | Cypher ì¿¼ë¦¬ ì „ì²´ ëª©ë¡ |
| `references/personas.md` | í˜ë¥´ì†Œë‚˜ë³„ ì‘ë‹µ ìŠ¤íƒ€ì¼ |
| `references/data-pipeline.md` | ë°ì´í„° ìˆ˜ì§‘/êµ¬ì¡°í™” ìƒì„¸ |
| `scripts/structurizer.py` | LLM êµ¬ì¡°í™” ìŠ¤í¬ë¦½íŠ¸ |
| `scripts/neo4j_loader.py` | ê·¸ë˜í”„ ì ì¬ ìŠ¤í¬ë¦½íŠ¸ |
| `scripts/query_engine.py` | ì¿¼ë¦¬ ì—”ì§„ í´ë˜ìŠ¤ |
